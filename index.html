<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>مشغل الفيديو باستخدام Plyr</title>
  <!-- إضافة رابط CSS لمكتبة Plyr -->
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.2/plyr.css" />
  <style>
      /* إزالة الحافات وجعل الصفحة تملأ الشاشة */
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }
      body, html {
          width: 100%;
          height: 100%;
          overflow: hidden; /* منع التمرير */
          display: flex;
          justify-content: center;
          align-items: center;
          background-color: #000;
      }
      #player {
          width: 100vw; /* عرض الشاشة بالكامل */
          height: 100vh; /* ارتفاع الشاشة بالكامل */
      }
      .plyr {
          width: 100%;
          height: 100%;
      }
  </style>
</head>
<body>
  <!-- إضافة مشغل الفيديو -->
  <div id="player"></div>

  <!-- إضافة رابط JavaScript لمكتبة Plyr -->
  <script src="https://cdn.plyr.io/3.7.2/plyr.js"></script>
  <script>
    // دالة لاستخراج رابط الفيديو من المعامل "url"
    function getVideoUrlFromQuery() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('url');
    }

    // دالة لاستخراج معرف الفيديو من رابط يوتيوب
    function getYouTubeVideoId(url) {
        const regex = /(?:https?:\/\/(?:www\.)?youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
        const match = url.match(regex);
        return match ? match[1] : null;
    }

    // الحصول على رابط الفيديو من عنوان URL الموقع
    const videoUrl = getVideoUrlFromQuery();

    if (videoUrl) {
        // استخراج معرف الفيديو
        const videoId = getYouTubeVideoId(videoUrl);

        if (videoId) {
            // تعيين معرف الفيديو في عنصر المشغل
            const playerDiv = document.getElementById('player');
            playerDiv.setAttribute('data-plyr-provider', 'youtube');
            playerDiv.setAttribute('data-plyr-embed-id', videoId);

            // تهيئة مشغل Plyr
            const player = new Plyr('#player', {
                settings: ['quality'], // تفعيل إعدادات الجودة
                controls: [
                    'play-large', // زر التشغيل الكبير
                    'play',
                    'progress',
                    'current-time',
                    'mute',
                    'volume',
                    'settings', // زر الإعدادات (يتضمن الجودة)
                ],
                quality: {
                    default: 720, // الجودة الافتراضية
                    options: [1080, 720, 480, 360, 240], // الخيارات المتاحة
                },
            });
        } else {
            console.error('لم يتم العثور على معرف الفيديو في الرابط.');
        }
    } else {
        console.error('لم يتم العثور على رابط الفيديو في المعامل "url=".');
    }
  </script>
</body>
</html>
